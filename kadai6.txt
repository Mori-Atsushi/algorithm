Script started on Fri Feb 12 11:15:56 2016
[?1034hbash-3.2$ cat bstree.c
/* E1237 æ£®ç¯¤å² */

#include <stdio.h>
#include <stdlib.h>

typedef struct node {
	int x;
	struct node *left;
	struct node *right;
} node_t;

node_t * root;

void search(int a, node_t *root) {
	if(root == NULL)
		printf("2åˆ†æ¢ç´¢æœ¨ã«æ•´æ•°%dã¯å­˜åœ¨ã—ã¾ã›ã‚“ã€‚\n", a);
	else if(a == root->x)
		printf("2åˆ†æ¢ç´¢æœ¨ã«æ•´æ•°%dã¯å­˜åœ¨ã—ã¾ã™ã€‚\n", a);
	else if(a < root->x)
		search(a, root->left);
	else
		search(a, root->right);
}

node_t *talloc(void) {
	return((node_t *) malloc(sizeof(node_t)));
}

node_t *insert(int a, node_t *root) {
	if(root == NULL) {
		root = talloc();
		root->x = a;
		root->left = NULL;
		root->right = NULL;
	} else if(a == root->x) {
		printf("æ•´æ•°%dã¯ã™ã§ã«2åˆ†æ¢ç´¢æœ¨ã«æŒ¿å…¥ã•ã‚Œã¦ã„ã¾ã™ã€‚\n", a);
	} else if(a < root->x) {
		root->left = insert(a, root->left);
	} else {
		root->right = insert(a, root->right);
	}
	return(root);
}

char children_type(node_t *ptr) {
	if(ptr->left == NULL) {
		if(ptr->right == NULL)
			return('n');
		else
			return('r');
	} else if(ptr->right == NULL) {
		if(ptr->left == NULL)
			return('l');
		else
			return('b');
	}
	return '0';
}

node_t *delete_node(node_t *ptr) {
	char c;
	node_t *p, *parent_of_p;

	c = children_type(ptr);

	if(c == 'n')
		ptr = NULL;
	else if(c == 'l')
		ptr = ptr->left;
	else if(c == 'r')
		ptr = ptr->right;
	else {
		p = ptr->right;
		if((children_type(p) == 'r') || (children_type(p) == 'n')) {
			p->left = ptr->left;
			ptr = p;
		} else {
			while(p->left != NULL) {
				parent_of_p = p;
				p = p->left;
			}
			parent_of_p->left = p->right;
			p->left = ptr->left;
			p->right = ptr->right;
			ptr = p;
		}
	}
	return(ptr);
}

node_t *delete_item(int a, node_t *root) {
	if(root == NULL)
		printf("æ•´æ•°%dã¯2åˆ†æ¢ç´¢æœ¨ã«å­˜åœ¨ã—ã¾ã›ã‚“ã€‚\n", a);
	else if(a == root->x)
		root = delete_node(root);
	else if(a < root->x)
		root->left = delete_item(a, root->left);
	else
		root->right = delete_item(a, root->right);
	return(root);
}

void print_inorder(node_t *root) {
	if(root != NULL) {
		print_inorder(root->left);
		printf("%d\n", root->x);
		print_inorder(root->right);
	}
}

int main(void) {
	char c;
	int a;
	root = NULL;

	while(1) {
		printf("ã‚³ãƒãƒ³ãƒ‰ï¼š");
		scanf(" %c", &c);
		switch(c) {
			case 's':
				scanf("%d", &a);
				search(a, root);
				break;
			case 'i':
				scanf("%d", &a);
				root = insert(a, root);
				break;
			case 'd':
				scanf("%d", &a);
				root = delete_item(a, root);
				break;
			case 'p':
				print_inorder(root);
				break;
			case 'q':
				return 0;
			default:
				printf("s, i, d, p, ã¾ãŸã¯qã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚\n");
		}
	}

	return 0;
}bash-3.2$ gcc bstree.c
bash-3.2$ ./a.out
ã‚³ãƒãƒ³ãƒ‰ï¼ši
3
ã‚³ãƒãƒ³ãƒ‰ï¼ši
5
ã‚³ãƒãƒ³ãƒ‰ï¼ši
1
ã‚³ãƒãƒ³ãƒ‰ï¼šp
1
3
5
ã‚³ãƒãƒ³ãƒ‰ï¼ši
3
æ•´æ•°3ã¯ã™ã§ã«2åˆ†æ¢ç´¢æœ¨ã«æŒ¿å…¥ã•ã‚Œã¦ã„ã¾ã™ã€‚
ã‚³ãƒãƒ³ãƒ‰ï¼šs
2
2åˆ†æ¢ç´¢æœ¨ã«æ•´æ•°2ã¯å­˜åœ¨ã—ã¾ã›ã‚“ã€‚
ã‚³ãƒãƒ³ãƒ‰ï¼šs
1
2åˆ†æ¢ç´¢æœ¨ã«æ•´æ•°1ã¯å­˜åœ¨ã—ã¾ã™ã€‚
ã‚³ãƒãƒ³ãƒ‰ï¼šd
3
ã‚³ãƒãƒ³ãƒ‰ï¼šp
1
5
ã‚³ãƒãƒ³ãƒ‰ï¼šd
2
æ•´æ•°2ã¯2åˆ†æ¢ç´¢æœ¨ã«å­˜åœ¨ã—ã¾ã›ã‚“ã€‚
ã‚³ãƒãƒ³ãƒ‰ï¼šq
bash-3.2$ exit
exit

Script done on Fri Feb 12 11:17:23 2016
