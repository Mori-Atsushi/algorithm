Script started on Mon Nov 30 01:26:24 2015
[?1034hbash-3.2$ cat ringbuffer.c
/* E1237 æ£®ç¯¤å² */

#include <stdio.h>

#define MAX 5 //ãƒ‡ãƒ¼ã‚¿æ•°

/*iã‚³ãƒãƒ³ãƒ‰*/
void i(int **h, int **t, int *r, int *d) {
	int x;
	int *tmp;
	if(*t == d) {
		*h = r;
		*t = r;
	} else {
		tmp = r + ((*t - r + 1) % MAX);
		if(tmp == *h) {
			printf("ã‚­ãƒ¥ãƒ¼ãŒæº€æ¯ã§ã™ã€‚\n");
			return ;
		}
		*t = tmp;
	}
	printf("å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ï¼š");
	scanf(" %d", &x);
	**t = x;
	return;
}

/*dã‚³ãƒãƒ³ãƒ‰*/
void d(int **h, int **t, int *r, int *d) {
	int *tmp;
	if(*h == d) {
		printf("ã‚­ãƒ¥ãƒ¼ãŒç©ºã§ã™ã€‚\n");
		return;
	}

	if(*h == *t) {
		*h = d;
		*t = d;
	} else {
		*h = r + ((*h - r + 1) % MAX);
	}
}

/*pã‚³ãƒãƒ³ãƒ‰*/
void p(int *h, int *t, int *r, int *d) {
	int *tmp;
	int i;
	if(h == d) {
		printf("ã‚­ãƒ¥ãƒ¼ãŒç©ºã§ã™ã€‚\n");
		return;
	}
	if(h == t) {
		printf("%d, \n", *h);
		return;
	}
	for(i = 0; i < 5; i++) {
		tmp = r + ((h - r + i) % MAX);
		printf("%d, ", *tmp);	
		if(tmp == t)
			break;
	}
	printf("\n");
}

int main(void) {
	int ring[MAX], dummy; //ãƒ‡ãƒ¼ã‚¿
	int *head = &dummy, *tail = &dummy; //ãƒªãƒ³ã‚°ãƒãƒƒãƒ•ã‚¡ã®ç¾åœ¨åœ°
	char c;

	while(1) {
		printf("ã‚³ãƒãƒ³ãƒ‰ï¼š");
		scanf(" %c", &c);
		switch(c) {
			case 'i':
				i(&head, &tail, ring, &dummy);
				break;
			case 'd':
				d(&head, &tail, ring, &dummy);
				break;
			case 'p':
				p(head, tail, ring, &dummy);
				break;
			case 'q':
				return 0;
			default :
				printf("i,d,p,qã®ã„ãšã‚Œã‹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚\n");
		}
	}
	return 0;
}bash-3.2$ gcc ringbuffer.c
bash-3.2$ ./a.out
ã‚³ãƒãƒ³ãƒ‰ï¼šp
ã‚­ãƒ¥ãƒ¼ãŒç©ºã§ã™ã€‚
ã‚³ãƒãƒ³ãƒ‰ï¼ši
å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ï¼š1
ã‚³ãƒãƒ³ãƒ‰ï¼ši
å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ï¼š2
ã‚³ãƒãƒ³ãƒ‰ï¼ši
å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ï¼š3
ã‚³ãƒãƒ³ãƒ‰ï¼ši
å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ï¼š4
ã‚³ãƒãƒ³ãƒ‰ï¼ši
å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ï¼š5
ã‚³ãƒãƒ³ãƒ‰ï¼šp
1, 2, 3, 4, 5, 
ã‚³ãƒãƒ³ãƒ‰ï¼ši
ã‚­ãƒ¥ãƒ¼ãŒæº€æ¯ã§ã™ã€‚
ã‚³ãƒãƒ³ãƒ‰ï¼šd
ã‚³ãƒãƒ³ãƒ‰ï¼šp
2, 3, 4, 5, 
ã‚³ãƒãƒ³ãƒ‰ï¼šd
ã‚³ãƒãƒ³ãƒ‰ï¼šd
ã‚³ãƒãƒ³ãƒ‰ï¼šd
ã‚³ãƒãƒ³ãƒ‰ï¼šd
ã‚³ãƒãƒ³ãƒ‰ï¼šd
ã‚­ãƒ¥ãƒ¼ãŒç©ºã§ã™ã€‚
ã‚³ãƒãƒ³ãƒ‰ï¼šp
ã‚­ãƒ¥ãƒ¼ãŒç©ºã§ã™ã€‚
ã‚³ãƒãƒ³ãƒ‰ï¼šq
bash-3.2$ exit
exit

Script done on Mon Nov 30 01:27:00 2015
